{% load static %}
{% load mathfilters %}
<style>
  .tabla_ficha {
    width: 100% ;
  }
  
  #tabla_ficha_body > tr > td {
    width: 25% ;
  }
</style>

<div class="modal fade" id="ficha_{{intercambiador.pk}}" tabindex="-1" aria-labelledby="ficha_{{intercambiador.pk}}Label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg">
      <div class="modal-content text-dark">
        <div class="modal-header">
          <h5 class="modal-title" id="ficha_{{intercambiador.pk}}Label">Ficha Técnica Tubo/Carcasa {{generales.tag}} ({{generales.planta}})</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body text-start small">
          <div class="row">
            <div class="col-12">
              <div class="row">
                <table class="table table-light text-center table-bordered tabla_ficha">
                  <tbody id="tabla_ficha_body">
                    <tr>
                      <th class="table-dark">Tag</th>
                      <td>{{generales.tag}}</td>
                      <td colspan="2" rowspan="5" style="vertical-align: middle;">
                        <img src="/static/img/temas/intercambiadores/{{generales.tema}}.png" class="w-100" alt="Imagen del Tema no Disponible">
                      </td>
                    </tr>
                    <tr>
                      <th class="table-dark">Planta</th>
                      <td>{{generales.planta}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Tema</th>
                      <td>{{generales.tema}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Fabricante</th>
                      <td>{{generales.fabricante}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Tipo</th>
                      <td>TUBO Y CARCASA</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Servicio</th>
                      <td colspan="3">{{generales.servicio}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="4">
                        <div class="d-inline-flex align-items-center">
                          Condiciones&nbsp;
                          <select name="condicion" id="condicion">
                            <option value="D">De Diseño</option>
                          </select>
                        </div>
                      </th>
                    </tr>
                    <tr>
                      <th colspan="2" class="table-dark">Ítem</th>
                      <th class="table-dark">Lado Carcasa</th>
                      <th class="table-dark">Lado Tubo</th>
                    </tr>
                    {% with condiciones_tubo=intercambiador.condicion_tubo %}
                    {% with condiciones_carcasa=intercambiador.condicion_carcasa %}
                    <tr>
                      <th class="table-dark" colspan="2">Fluido</th>
                      <td>
                        {% if intercambiador.fluido_carcasa %}
                          {{intercambiador.fluido_carcasa}}
                        {% else %}
                          {{condiciones_carcasa.fluido_etiqueta}}
                        {% endif %}
                      </td>
                      <td>
                        {% if intercambiador.fluido_tubo %}
                          {{intercambiador.fluido_tubo}}
                        {% else %}
                          {{condiciones_tubo.fluido_etiqueta}}
                        {% endif %}                        
                      </td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Capacidad Calorífica ({{condiciones_tubo.unidad_cp}})</th>
                      <td>
                          {{condiciones_carcasa.fluido_cp}}                 
                      </td>
                      <td>
                          {{condiciones_tubo.fluido_cp}}
                      </td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Temperatura IN ({{condiciones_tubo.temperaturas_unidad}})</th>
                      <td>{{condiciones_carcasa.temp_entrada}}</td>
                      <td>{{condiciones_tubo.temp_entrada}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Temperatura OUT ({{condiciones_tubo.temperaturas_unidad}})</th>
                      <td>{{condiciones_carcasa.temp_salida}}</td>
                      <td>{{condiciones_tubo.temp_salida}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Flujo Másico ({{condiciones_carcasa.flujos_unidad}})</th>
                      <td>{{condiciones_carcasa.flujo_masico}}</td>
                      <td>{{condiciones_tubo.flujo_masico}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Flujo Vapor IN ({{condiciones_carcasa.flujos_unidad}})</th>
                      <td>{% if condiciones_carcasa.flujo_vapor_entrada %}{{condiciones_carcasa.flujo_vapor_entrada}}{% else %}-{% endif %}</td>
                      <td>{% if condiciones_tubo.flujo_vapor_entrada %}{{condiciones_tubo.flujo_vapor_entrada}}{% else %}-{% endif %}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Flujo Vapor OUT ({{condiciones_carcasa.flujos_unidad}})</th>
                      <td>{% if condiciones_carcasa.flujo_vapor_salida %}{{condiciones_carcasa.flujo_vapor_salida}}{% else %}-{% endif %}</td>
                      <td>{% if condiciones_tubo.flujo_vapor_salida %}{{condiciones_tubo.flujo_vapor_salida}}{% else %}-{% endif %}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Flujo Líquido IN ({{condiciones_carcasa.flujos_unidad}})</th>
                      <td>{% if condiciones_carcasa.flujo_liquido_entrada %}{{condiciones_carcasa.flujo_liquido_entrada}}{% else %}-{% endif %}</td>
                      <td>{% if condiciones_tubo.flujo_liquido_entrada %}{{condiciones_tubo.flujo_liquido_entrada}}{% else %}-{% endif %}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Flujo Líquido OUT ({{condiciones_carcasa.flujos_unidad}})</th>
                      <td>{% if condiciones_carcasa.flujo_liquido_salida %}{{condiciones_carcasa.flujo_liquido_salida}}{% else %}-{% endif %}</td>
                      <td>{% if condiciones_tubo.flujo_liquido_salida %}{{condiciones_tubo.flujo_liquido_salida}}{% else %}-{% endif %}</td>
                    </tr>
                    <tr>
                      <th style="vertical-align: middle;" class="table-dark" colspan="2">Cambio de Fase</th>
                      <td>{{condiciones_carcasa.cambio_fase_largo}}</td>
                      <td>{{condiciones_tubo.cambio_fase_largo}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Caída Presión Entrada ({{condiciones_carcasa.unidad_presion}})</th>
                      <td>{{condiciones_carcasa.presion_entrada}}</td>
                      <td>{{condiciones_tubo.presion_entrada}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Caída Presión Máxima ({{condiciones_carcasa.unidad_presion}})</th>
                      <td>{{condiciones_carcasa.caida_presion_max}}</td>
                      <td>{{condiciones_tubo.caida_presion_max}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Caída Presión Mínima ({{condiciones_carcasa.unidad_presion}})</th>
                      <td>{{condiciones_carcasa.caida_presion_min}}</td>
                      <td>{{condiciones_tubo.caida_presion_min}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Fouling ({{intercambiador.ensuciamiento_unidad}})</th>
                      <td>{{condiciones_carcasa.fouling}}</td>
                      <td>{{condiciones_tubo.fouling}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Conexiones de Entrada</th>
                      <td>{{intercambiador.conexiones_entrada_carcasa}}</td>
                      <td>{{intercambiador.conexiones_entrada_tubos}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark" colspan="2">Conexiones de Salida</th>
                      <td>{{intercambiador.conexiones_salida_carcasa}}</td>
                      <td>{{intercambiador.conexiones_salida_tubos}}</td>
                    </tr>
                    {% endwith %}
                    {% endwith %}
                    <tr>
                      <th class="table-dark" colspan="4">Parámetros Adicionales</th>
                    </tr>
                    <tr>
                      <th class="table-dark">Calor ({{intercambiador.q_unidad}})</th>
                      <td>{{intercambiador.q}}</td>
                      <th class="table-dark">U ({{intercambiador.u_unidad}})</th>
                      <td>{{intercambiador.u}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Ensuciamiento ({{intercambiador.ensuciamiento_unidad}})</th>
                      <td>{{intercambiador.ensuciamiento}}</td>
                      <th class="table-dark">Área ({{intercambiador.area_unidad}})</th>
                      <td>{{intercambiador.area}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Arreglo Serie</th>
                      <td>{{intercambiador.arreglo_serie}}</td>
                      <th class="table-dark">Arreglo Paralelo</th>
                      <td>{{intercambiador.arreglo_paralelo}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">No. Tubos</th>
                      <td>{{intercambiador.numero_tubos}}</td>
                      <th class="table-dark">Long. Tubos ({{intercambiador.longitud_tubos_unidad}})</th>
                      <td>{{intercambiador.longitud_tubos}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">OD Tubos ({{intercambiador.diametro_tubos_unidad}})</th>
                      <td>{{intercambiador.diametro_externo_tubos}}</td>
                      <th class="table-dark">ID Carcasa ({{intercambiador.diametro_tubos_unidad}})</th>
                      <td>{{intercambiador.diametro_interno_tubos}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Pitch ({{intercambiador.unidades_pitch}})</th>
                      <td>{{intercambiador.pitch_tubos}}</td>
                      <th class="table-dark">Tipo Tubo</th>
                      <td>{{intercambiador.tipo_tubo}}</td>                      
                    </tr>
                    <tr>
                      <th class="table-dark">Material Carc.</th>
                      <td>{{intercambiador.material_carcasa}}</td>
                      <th colspan="1" class="table-dark">Material Tubo</th>
                      <td>{{intercambiador.material_tubo}}</td>
                    </tr>
                    <tr>
                      <th class="table-dark">Criticidad</th>
                      <td colspan="3">{{intercambiador.criticidad_larga}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          {% if request.user.is_superuser %}
          <a href="{% url 'editar_tubo_carcasa' pk=intercambiador.pk %}" class="btn btn-primary d-inline-flex" style="color: black;">Editar Información</a>
          {% endif %}
          <button class="btn btn-danger d-inline-flex" style="color: black;"><img src="{% static 'img/iconos/pdf.png' %}" width="20px" alt="Ícono Reporte PDF">&nbsp;Guardar PDF</button>
          <button class="btn btn-success d-inline-flex" style="color: black;"><img src="{% static 'img/iconos/xlsx.png' %}" width="20px" alt="Ícono Reporte XLSX">&nbsp;Guardar XLSX</button>
        </div>
      </div>
    </div>
</div>